---
interface Props {
    href: string;
    label: string;
}

const { href, label } = Astro.props;
---

<a class="lang-switch" href={href} data-lang-switch>{label}</a>

<script is:inline>
    document.querySelectorAll("[data-lang-switch]").forEach((element) => {
        element.addEventListener('click', () => {
            const href = element.getAttribute("href") || "/";
            const newLocale = href.startsWith("/zh/") ? "zh-CN" : "en-US";
            localStorage.setItem("preferred-locale", newLocale);
        });

        const anchor = element;
        if (!(anchor instanceof HTMLAnchorElement)) {
            return;
        }

        const baseHref = anchor.getAttribute("href") || "/";
        const hash = window.location.hash;
        if (hash) {
            anchor.href = `${baseHref}${hash}`;
        }
    });
</script>
